function plot_color_cepstrum(gram,data,Fs,n_anal,factor,n_step,titletext)                    % Author D.R.Ohm% Oct.4,2004% gram --  a 2-D array of values from Cepstrum Analysis script, %          % data --  The original data array (data must be complex-valued)% Fs --    The sampling rate in samples per second (Hz)% interval --  The analysis interval used to create gram, in number of%              samples (use same value as entered in the%              TFA_Analysis_complex script% factor% int_overlap  --  The overlap between analysis center times, in number of%                  samples.% titletext -- Title of gram plot entered between quotes ('STFT ...')%**************************************************************************%**************************************************************************Ts=1/Fs;    % sampling interval in sec [n_rows,n_cols]=size(gram);max_gram = max(max(abs(gram)));log_gram = 20*log10(abs(gram)/max_gram);dB_top = input('Enter top range in dB (ex.10): ');dB_bottom = input('Enter bottom range in dB (ex.40): ');vec = find(log_gram < (-dB_bottom));log_gram(vec) = -dB_bottom*ones(size(vec));vec = find(log_gram > (-dB_top));log_gram(vec) = -dB_top*ones(size(vec));selection = input('Enter 0 for gray scale, 1 for color scale: ');%%% Plot Titlefig1 = figure('PaperOrientation','portrait',...              'PaperPosition',[1.1,1,6.5,9],...              'Position',[10,10,820,620],...              'Units','pixel');pmax = (factor*n_anal/2-1)*Ts;    % max periodtmax = (n_rows-1)*n_step*Ts;    % max time in seconds p_axis = (0:factor*n_anal/2-1)*Ts;axwidth = .75;ax_title = axes('Position',[.2,.97,axwidth,1],...                'Units','normalized',...                'Visible','off');% Figure titletitle_text = text('Position',[.5,0],...                  'Units','normalized',...                  'FontSize',[12],...                  'HorizontalAlignment','center',...                  'VerticalAlignment','bottom',...                  'String',' CENTER TIME - VS - PERIOD GRAM');% Center-time vs Period gram plotaxbottom = .19;axheight = .73;t_spacing = .05*tmax;  % spacing between time ticks in msp_spacing = (.05*pmax);   % spacing between x axis ticksnt_tick = (tmax/t_spacing);YY = t_spacing*(0:nt_tick);nf_tick = (pmax/p_spacing);pmax_b = 0;nf_tick_b = 0;XX = p_spacing*(nf_tick_b:nf_tick)';ax1 = axes('Position',[.20,axbottom,axwidth,axheight],...           'Units','normalized',...           'FontSize',[12],...           'Box','on',...           'TickDir','out',...           'NextPlot','add',...           'XGrid','off',...           'XLim',[pmax_b,pmax],...           'YLim',[0,tmax],...           'XTick',XX,...           'YTick',YY);if selection == 0    colormap(gray(256));else    map = hsv(329);    colormap(map(256:-1:1,:));endtitle(titletext)set(ax1,'FontSize',[9])t_axis = (0:n_rows-1)*n_step*Ts;xlabel('Period  (seconds)')ylabel('Center Time of Analysis Window (seconds)')imagesc(p_axis,t_axis,log_gram)% Signal-vs-time plot to left gram plotdata_max = max(abs(data));%data_max = max(abs(data));ax2 = axes('Position',[.01,axbottom,.11,axheight],...           'Units','normalized',...           'Box','on',...           'NextPlot','add',...           'FontSize',[9],...           'XLim',[-data_max,data_max],...           'XDir','reverse',...           'YTickLabelMode','manual',...           'YTickLabel',[],...           'YLim',[0,tmax]);    t_axis = (1:length(data))*Ts;plot(real(data),t_axis,'k')xlabel('Signal Amplitude')%% 1-D plot of cepstrum at half-way point in data recorddB_range = dB_bottom+5;       ax4 = axes('Position',[.20,.03,axwidth,.09],...           'Units','normalized',...           'Box','on',...           'NextPlot','add',...           'FontSize',[9],...           'TickDir','in',...           'XTickLabelMode','manual',...           'XTickLabel',[],...           'XLim',[0,pmax],...           'YLim',[-dB_range,-10]);    plot(p_axis,log_gram(fix(n_rows/2),:))center_time = fix(n_rows/2)*n_step*Ts;ylabel(['Time = ',int2str(center_time),'s'])%Color bar legend on left bottomax5 = axes('Position',[.01,.07,.10,.03],...           'Units','normalized',...           'Box','on',...           'NextPlot','add',...           'FontSize',[9],...           'YLim',[1,2],...           'TickDir','out',...           'YTickLabelMode','manual',...           'YTickLabel',[],...           'XLim',[-dB_bottom,-dB_top]);vec = (-dB_bottom:-dB_top)';barr = [vec vec]';imagesc((-dB_bottom:-dB_top),(1:2),barr)xlabel('dB colormap')